(function(t,e){"object"==typeof exports?module.exports=e(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"==typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],e):t.URI=e(t.punycode,t.IPv6,t.SecondLevelDomains)})(this,function(t,e,r){"use strict";function n(t,e){return this instanceof n?(void 0===t&&(t="undefined"!=typeof location?location.href+"":""),this.href(t),void 0!==e?this.absoluteTo(e):this):new n(t,e)}function i(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function s(t){return(Object.prototype.toString.call(t)+"").slice(8,-1)}function a(t){return"Array"===s(t)}function o(t,e){var r,n,i={};if(a(e))for(r=0,n=e.length;n>r;r++)i[e[r]]=!0;else i[e]=!0;for(r=0,n=t.length;n>r;r++)void 0!==i[t[r]]&&(t.splice(r,1),n--,r--);return t}function u(t,e){var r,n;if(a(e)){for(r=0,n=e.length;n>r;r++)if(!u(t,e[r]))return!1;return!0}var i=s(e);for(r=0,n=t.length;n>r;r++)if("RegExp"===i){if("string"==typeof t[r]&&t[r].match(e))return!0}else if(t[r]===e)return!0;return!1}function h(t,e){if(!a(t)||!a(e))return!1;if(t.length!==e.length)return!1;t.sort(),e.sort();for(var r=0,n=t.length;n>r;r++)if(t[r]!==e[r])return!1;return!0}function p(t){return encodeURIComponent(t).replace(/[!'()*]/g,escape).replace(/\*/g,"%2A")}var c=n.prototype,l=Object.prototype.hasOwnProperty;n._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:n.duplicateQueryParameters}},n.duplicateQueryParameters=!1,n.protocol_expression=/^[a-z][a-z0-9-+-]*$/i,n.idn_expression=/[^a-z0-9\.-]/i,n.punycode_expression=/(xn--)/i,n.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,n.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,n.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi,n.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},n.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/,n.encode=p,n.decode=decodeURIComponent,n.iso8859=function(){n.encode=escape,n.decode=unescape},n.unicode=function(){n.encode=p,n.decode=decodeURIComponent},n.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}}},n.encodeQuery=function(t){return n.encode(t+"").replace(/%20/g,"+")},n.decodeQuery=function(t){return n.decode((t+"").replace(/\+/g,"%20"))},n.recodePath=function(t){for(var e=(t+"").split("/"),r=0,i=e.length;i>r;r++)e[r]=n.encodePathSegment(n.decode(e[r]));return e.join("/")},n.decodePath=function(t){for(var e=(t+"").split("/"),r=0,i=e.length;i>r;r++)e[r]=n.decodePathSegment(e[r]);return e.join("/")};var d,f={encode:"encode",decode:"decode"},m=function(t,e){return function(r){return n[e](r+"").replace(n.characters[t][e].expression,function(r){return n.characters[t][e].map[r]})}};for(d in f)n[d+"PathSegment"]=m("pathname",f[d]);n.encodeReserved=m("reserved","encode"),n.parse=function(t,e){var r;return e||(e={}),r=t.indexOf("#"),r>-1&&(e.fragment=t.substring(r+1)||null,t=t.substring(0,r)),r=t.indexOf("?"),r>-1&&(e.query=t.substring(r+1)||null,t=t.substring(0,r)),"//"===t.substring(0,2)?(e.protocol="",t=t.substring(2),t=n.parseAuthority(t,e)):(r=t.indexOf(":"),r>-1&&(e.protocol=t.substring(0,r),e.protocol&&!e.protocol.match(n.protocol_expression)?e.protocol=void 0:"file"===e.protocol?t=t.substring(r+3):"//"===t.substring(r+1,r+3)?(t=t.substring(r+3),t=n.parseAuthority(t,e)):(t=t.substring(r+1),e.urn=!0))),e.path=t,e},n.parseHost=function(t,e){var r,n,i=t.indexOf("/");return-1===i&&(i=t.length),"["===t.charAt(0)?(r=t.indexOf("]"),e.hostname=t.substring(1,r)||null,e.port=t.substring(r+2,i)||null):t.indexOf(":")!==t.lastIndexOf(":")?(e.hostname=t.substring(0,i)||null,e.port=null):(n=t.substring(0,i).split(":"),e.hostname=n[0]||null,e.port=n[1]||null),e.hostname&&"/"!==t.substring(i).charAt(0)&&(i++,t="/"+t),t.substring(i)||"/"},n.parseAuthority=function(t,e){return t=n.parseUserinfo(t,e),n.parseHost(t,e)},n.parseUserinfo=function(t,e){var r,i=t.indexOf("@"),s=t.indexOf("/");return i>-1&&(-1===s||s>i)?(r=t.substring(0,i).split(":"),e.username=r[0]?n.decode(r[0]):null,r.shift(),e.password=r[0]?n.decode(r.join(":")):null,t=t.substring(i+1)):(e.username=null,e.password=null),t},n.parseQuery=function(t){if(!t)return{};if(t=t.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!t)return{};for(var e,r,i,s={},a=t.split("&"),o=a.length,u=0;o>u;u++)e=a[u].split("="),r=n.decodeQuery(e.shift()),i=e.length?n.decodeQuery(e.join("=")):null,s[r]?("string"==typeof s[r]&&(s[r]=[s[r]]),s[r].push(i)):s[r]=i;return s},n.build=function(t){var e="";return t.protocol&&(e+=t.protocol+":"),t.urn||!e&&!t.hostname||(e+="//"),e+=n.buildAuthority(t)||"","string"==typeof t.path&&("/"!==t.path.charAt(0)&&"string"==typeof t.hostname&&(e+="/"),e+=t.path),"string"==typeof t.query&&t.query&&(e+="?"+t.query),"string"==typeof t.fragment&&t.fragment&&(e+="#"+t.fragment),e},n.buildHost=function(t){var e="";return t.hostname?(n.ip6_expression.test(t.hostname)?e+=t.port?"["+t.hostname+"]:"+t.port:t.hostname:(e+=t.hostname,t.port&&(e+=":"+t.port)),e):""},n.buildAuthority=function(t){return n.buildUserinfo(t)+n.buildHost(t)},n.buildUserinfo=function(t){var e="";return t.username&&(e+=n.encode(t.username),t.password&&(e+=":"+n.encode(t.password)),e+="@"),e},n.buildQuery=function(t,e){var r,i,s,o,u="";for(i in t)if(l.call(t,i)&&i)if(a(t[i]))for(r={},s=0,o=t[i].length;o>s;s++)void 0!==t[i][s]&&void 0===r[t[i][s]+""]&&(u+="&"+n.buildQueryParameter(i,t[i][s]),e!==!0&&(r[t[i][s]+""]=!0));else void 0!==t[i]&&(u+="&"+n.buildQueryParameter(i,t[i]));return u.substring(1)},n.buildQueryParameter=function(t,e){return n.encodeQuery(t)+(null!==e?"="+n.encodeQuery(e):"")},n.addQuery=function(t,e,r){if("object"==typeof e)for(var i in e)l.call(e,i)&&n.addQuery(t,i,e[i]);else{if("string"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===t[e])return t[e]=r,void 0;"string"==typeof t[e]&&(t[e]=[t[e]]),a(r)||(r=[r]),t[e]=t[e].concat(r)}},n.removeQuery=function(t,e,r){var i,s,u;if(a(e))for(i=0,s=e.length;s>i;i++)t[e[i]]=void 0;else if("object"==typeof e)for(u in e)l.call(e,u)&&n.removeQuery(t,u,e[u]);else{if("string"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the first parameter");void 0!==r?t[e]===r?t[e]=void 0:a(t[e])&&(t[e]=o(t[e],r)):t[e]=void 0}},n.hasQuery=function(t,e,r,i){if("object"==typeof e){for(var o in e)if(l.call(e,o)&&!n.hasQuery(t,o,e[o]))return!1;return!0}if("string"!=typeof e)throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter");switch(s(r)){case"Undefined":return e in t;case"Boolean":var p=Boolean(a(t[e])?t[e].length:t[e]);return r===p;case"Function":return!!r(t[e],e,t);case"Array":if(!a(t[e]))return!1;var c=i?u:h;return c(t[e],r);case"RegExp":return a(t[e])?i?u(t[e],r):!1:Boolean(t[e]&&t[e].match(r));case"Number":r+="";case"String":return a(t[e])?i?u(t[e],r):!1:t[e]===r;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},n.commonPath=function(t,e){var r,n=Math.min(t.length,e.length);for(r=0;n>r;r++)if(t.charAt(r)!==e.charAt(r)){r--;break}return 1>r?t.charAt(0)===e.charAt(0)&&"/"===t.charAt(0)?"/":"":("/"!==t.charAt(r)&&(r=t.substring(0,r).lastIndexOf("/")),t.substring(0,r+1))},n.withinString=function(t,e){return t.replace(n.find_uri_expression,e)},n.ensureValidHostname=function(e){if(e.match(n.invalid_hostname_characters)){if(!t)throw new TypeError("Hostname '"+e+"' contains characters other than [A-Z0-9.-] and Punycode.js is not available");if(t.toASCII(e).match(n.invalid_hostname_characters))throw new TypeError("Hostname '"+e+"' contains characters other than [A-Z0-9.-]")}},c.build=function(t){return t===!0?this._deferred_build=!0:(void 0===t||this._deferred_build)&&(this._string=n.build(this._parts),this._deferred_build=!1),this},c.clone=function(){return new n(this)},c.valueOf=c.toString=function(){return this.build(!1)._string},f={protocol:"protocol",username:"username",password:"password",hostname:"hostname",port:"port"},m=function(t){return function(e,r){return void 0===e?this._parts[t]||"":(this._parts[t]=e,this.build(!r),this)}};for(d in f)c[d]=m(f[d]);f={query:"?",fragment:"#"},m=function(t,e){return function(r,n){return void 0===r?this._parts[t]||"":(null!==r&&(r+="",r.charAt(0)===e&&(r=r.substring(1))),this._parts[t]=r,this.build(!n),this)}};for(d in f)c[d]=m(d,f[d]);f={search:["?","query"],hash:["#","fragment"]},m=function(t,e){return function(r,n){var i=this[t](r,n);return"string"==typeof i&&i.length?e+i:i}};for(d in f)c[d]=m(f[d][1],f[d][0]);c.pathname=function(t,e){if(void 0===t||t===!0){var r=this._parts.path||(this._parts.urn?"":"/");return t?n.decodePath(r):r}return this._parts.path=t?n.recodePath(t):"/",this.build(!e),this},c.path=c.pathname,c.href=function(t,e){var r;if(void 0===t)return""+this;this._string="",this._parts=n._parts();var i=t instanceof n,s="object"==typeof t&&(t.hostname||t.path);if(!i&&s&&void 0!==t.pathname&&(t=""+t),"string"==typeof t)this._parts=n.parse(t,this._parts);else{if(!i&&!s)throw new TypeError("invalid input");var a=i?t._parts:t;for(r in a)l.call(this._parts,r)&&(this._parts[r]=a[r])}return this.build(!e),this},c.is=function(t){var e=!1,i=!1,s=!1,a=!1,o=!1,u=!1,h=!1,p=!this._parts.urn;switch(this._parts.hostname&&(p=!1,i=n.ip4_expression.test(this._parts.hostname),s=n.ip6_expression.test(this._parts.hostname),e=i||s,a=!e,o=a&&r&&r.has(this._parts.hostname),u=a&&n.idn_expression.test(this._parts.hostname),h=a&&n.punycode_expression.test(this._parts.hostname)),t.toLowerCase()){case"relative":return p;case"absolute":return!p;case"domain":case"name":return a;case"sld":return o;case"ip":return e;case"ip4":case"ipv4":case"inet4":return i;case"ip6":case"ipv6":case"inet6":return s;case"idn":return u;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return h}return null};var g=c.protocol,v=c.port,y=c.hostname;c.protocol=function(t,e){if(void 0!==t&&t&&(t=t.replace(/:(\/\/)?$/,""),t.match(/[^a-zA-z0-9\.+-]/)))throw new TypeError("Protocol '"+t+"' contains characters other than [A-Z0-9.+-]");return g.call(this,t,e)},c.scheme=c.protocol,c.port=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0!==t&&(0===t&&(t=null),t&&(t+="",":"===t.charAt(0)&&(t=t.substring(1)),t.match(/[^0-9]/))))throw new TypeError("Port '"+t+"' contains characters other than [0-9]");return v.call(this,t,e)},c.hostname=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0!==t){var r={};n.parseHost(t,r),t=r.hostname}return y.call(this,t,e)},c.host=function(t,e){return this._parts.urn?void 0===t?"":this:void 0===t?this._parts.hostname?n.buildHost(this._parts):"":(n.parseHost(t,this._parts),this.build(!e),this)},c.authority=function(t,e){return this._parts.urn?void 0===t?"":this:void 0===t?this._parts.hostname?n.buildAuthority(this._parts):"":(n.parseAuthority(t,this._parts),this.build(!e),this)},c.userinfo=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t){if(!this._parts.username)return"";var r=n.buildUserinfo(this._parts);return r.substring(0,r.length-1)}return"@"!==t[t.length-1]&&(t+="@"),n.parseUserinfo(t,this._parts),this.build(!e),this},c.resource=function(t,e){var r;return void 0===t?this.path()+this.search()+this.hash():(r=n.parse(t),this._parts.path=r.path,this._parts.query=r.query,this._parts.fragment=r.fragment,this.build(!e),this)},c.subdomain=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,r)||""}var s=this._parts.hostname.length-this.domain().length,a=this._parts.hostname.substring(0,s),o=RegExp("^"+i(a));return t&&"."!==t.charAt(t.length-1)&&(t+="."),t&&n.ensureValidHostname(t),this._parts.hostname=this._parts.hostname.replace(o,t),this.build(!e),this},c.domain=function(t,e){if(this._parts.urn)return void 0===t?"":this;if("boolean"==typeof t&&(e=t,t=void 0),void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.match(/\./g);if(r&&2>r.length)return this._parts.hostname;var s=this._parts.hostname.length-this.tld(e).length-1;return s=this._parts.hostname.lastIndexOf(".",s-1)+1,this._parts.hostname.substring(s)||""}if(!t)throw new TypeError("cannot set domain empty");if(n.ensureValidHostname(t),!this._parts.hostname||this.is("IP"))this._parts.hostname=t;else{var a=RegExp(i(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(a,t)}return this.build(!e),this},c.tld=function(t,e){if(this._parts.urn)return void 0===t?"":this;if("boolean"==typeof t&&(e=t,t=void 0),void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf("."),s=this._parts.hostname.substring(n+1);return e!==!0&&r&&r.list[s.toLowerCase()]?r.get(this._parts.hostname)||s:s}var a;if(!t)throw new TypeError("cannot set TLD empty");if(t.match(/[^a-zA-Z0-9-]/)){if(!r||!r.is(t))throw new TypeError("TLD '"+t+"' contains characters other than [A-Z0-9]");a=RegExp(i(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(a,t)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");a=RegExp(i(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(a,t)}return this.build(!e),this},c.directory=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||t===!0){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var r=this._parts.path.length-this.filename().length-1,s=this._parts.path.substring(0,r)||(this._parts.hostname?"/":"");return t?n.decodePath(s):s}var a=this._parts.path.length-this.filename().length,o=this._parts.path.substring(0,a),u=RegExp("^"+i(o));return this.is("relative")||(t||(t="/"),"/"!==t.charAt(0)&&(t="/"+t)),t&&"/"!==t.charAt(t.length-1)&&(t+="/"),t=n.recodePath(t),this._parts.path=this._parts.path.replace(u,t),this.build(!e),this},c.filename=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||t===!0){if(!this._parts.path||"/"===this._parts.path)return"";var r=this._parts.path.lastIndexOf("/"),s=this._parts.path.substring(r+1);return t?n.decodePathSegment(s):s}var a=!1;"/"===t.charAt(0)&&(t=t.substring(1)),t.match(/\.?\//)&&(a=!0);var o=RegExp(i(this.filename())+"$");return t=n.recodePath(t),this._parts.path=this._parts.path.replace(o,t),a?this.normalizePath(e):this.build(!e),this},c.suffix=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||t===!0){if(!this._parts.path||"/"===this._parts.path)return"";var r,s,a=this.filename(),o=a.lastIndexOf(".");return-1===o?"":(r=a.substring(o+1),s=/^[a-z0-9%]+$/i.test(r)?r:"",t?n.decodePathSegment(s):s)}"."===t.charAt(0)&&(t=t.substring(1));var u,h=this.suffix();if(h)u=t?RegExp(i(h)+"$"):RegExp(i("."+h)+"$");else{if(!t)return this;this._parts.path+="."+n.recodePath(t)}return u&&(t=n.recodePath(t),this._parts.path=this._parts.path.replace(u,t)),this.build(!e),this},c.segment=function(t,e,r){var n=this._parts.urn?":":"/",i=this.path(),s="/"===i.substring(0,1),o=i.split(n);if("number"!=typeof t&&(r=e,e=t,t=void 0),void 0!==t&&"number"!=typeof t)throw Error("Bad segment '"+t+"', must be 0-based integer");return s&&o.shift(),0>t&&(t=Math.max(o.length+t,0)),void 0===e?void 0===t?o:o[t]:(null===t||void 0===o[t]?a(e)?o=e:(e||"string"==typeof e&&e.length)&&(""===o[o.length-1]?o[o.length-1]=e:o.push(e)):e||"string"==typeof e&&e.length?o[t]=e:o.splice(t,1),s&&o.unshift(""),this.path(o.join(n),r))};var b=c.query;return c.query=function(t,e){if(t===!0)return n.parseQuery(this._parts.query);if("function"==typeof t){var r=n.parseQuery(this._parts.query),i=t.call(this,r);return this._parts.query=n.buildQuery(i||r,this._parts.duplicateQueryParameters),this.build(!e),this}return void 0!==t&&"string"!=typeof t?(this._parts.query=n.buildQuery(t,this._parts.duplicateQueryParameters),this.build(!e),this):b.call(this,t,e)},c.setQuery=function(t,e,r){var i=n.parseQuery(this._parts.query);if("object"==typeof t)for(var s in t)l.call(t,s)&&(i[s]=t[s]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");i[t]=void 0!==e?e:null}return this._parts.query=n.buildQuery(i,this._parts.duplicateQueryParameters),"string"!=typeof t&&(r=e),this.build(!r),this},c.addQuery=function(t,e,r){var i=n.parseQuery(this._parts.query);return n.addQuery(i,t,void 0===e?null:e),this._parts.query=n.buildQuery(i,this._parts.duplicateQueryParameters),"string"!=typeof t&&(r=e),this.build(!r),this},c.removeQuery=function(t,e,r){var i=n.parseQuery(this._parts.query);return n.removeQuery(i,t,e),this._parts.query=n.buildQuery(i,this._parts.duplicateQueryParameters),"string"!=typeof t&&(r=e),this.build(!r),this},c.hasQuery=function(t,e,r){var i=n.parseQuery(this._parts.query);return n.hasQuery(i,t,e,r)},c.setSearch=c.setQuery,c.addSearch=c.addQuery,c.removeSearch=c.removeQuery,c.hasSearch=c.hasQuery,c.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},c.normalizeProtocol=function(t){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!t)),this},c.normalizeHostname=function(r){return this._parts.hostname&&(this.is("IDN")&&t?this._parts.hostname=t.toASCII(this._parts.hostname):this.is("IPv6")&&e&&(this._parts.hostname=e.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!r)),this},c.normalizePort=function(t){return"string"==typeof this._parts.protocol&&this._parts.port===n.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!t)),this},c.normalizePath=function(t){if(this._parts.urn)return this;if(!this._parts.path||"/"===this._parts.path)return this;var e,r,i,s,a=this._parts.path;for("/"!==a.charAt(0)&&("."===a.charAt(0)&&(r=a.substring(0,a.indexOf("/"))),e=!0,a="/"+a),a=a.replace(/(\/(\.\/)+)|\/{2,}/g,"/");;){if(i=a.indexOf("/../"),-1===i)break;if(0===i){a=a.substring(3);break}s=a.substring(0,i).lastIndexOf("/"),-1===s&&(s=i),a=a.substring(0,s)+a.substring(i+3)}return e&&this.is("relative")&&(a=r?r+a:a.substring(1)),a=n.recodePath(a),this._parts.path=a,this.build(!t),this},c.normalizePathname=c.normalizePath,c.normalizeQuery=function(t){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(n.parseQuery(this._parts.query)):this._parts.query=null,this.build(!t)),this},c.normalizeFragment=function(t){return this._parts.fragment||(this._parts.fragment=null,this.build(!t)),this},c.normalizeSearch=c.normalizeQuery,c.normalizeHash=c.normalizeFragment,c.iso8859=function(){var t=n.encode,e=n.decode;return n.encode=escape,n.decode=decodeURIComponent,this.normalize(),n.encode=t,n.decode=e,this},c.unicode=function(){var t=n.encode,e=n.decode;return n.encode=p,n.decode=unescape,this.normalize(),n.encode=t,n.decode=e,this},c.readable=function(){var e=this.clone();e.username("").password("").normalize();var r="";if(e._parts.protocol&&(r+=e._parts.protocol+"://"),e._parts.hostname&&(e.is("punycode")&&t?(r+=t.toUnicode(e._parts.hostname),e._parts.port&&(r+=":"+e._parts.port)):r+=e.host()),e._parts.hostname&&e._parts.path&&"/"!==e._parts.path.charAt(0)&&(r+="/"),r+=e.path(!0),e._parts.query){for(var i="",s=0,a=e._parts.query.split("&"),o=a.length;o>s;s++){var u=(a[s]||"").split("=");i+="&"+n.decodeQuery(u[0]).replace(/&/g,"%26"),void 0!==u[1]&&(i+="="+n.decodeQuery(u[1]).replace(/&/g,"%26"))}r+="?"+i.substring(1)}return r+=e.hash()},c.absoluteTo=function(t){var e,r,i,s=this.clone(),a=["protocol","username","password","hostname","port"];if(this._parts.urn)throw Error("URNs do not have any generally defined hierachical components");if(t instanceof n||(t=new n(t)),s._parts.protocol||(s._parts.protocol=t._parts.protocol),this._parts.hostname)return s;for(r=0,i;i=a[r];r++)s._parts[i]=t._parts[i];for(a=["query","path"],r=0,i;i=a[r];r++)!s._parts[i]&&t._parts[i]&&(s._parts[i]=t._parts[i]);return"/"!==s.path().charAt(0)&&(e=t.directory(),s._parts.path=(e?e+"/":"")+s._parts.path,s.normalizePath()),s.build(),s},c.relativeTo=function(t){var e,r,s,a,o,u=this.clone(),h=["protocol","username","password","hostname","port"];if(this._parts.urn)throw Error("URNs do not have any generally defined hierachical components");if(t instanceof n||(t=new n(t)),"/"!==this.path().charAt(0)||"/"!==t.path().charAt(0))throw Error("Cannot calculate common path from non-relative URLs");if(e=n.commonPath(u.path(),t.path()),!e||"/"===e)return u;for(var p,c=0;p=h[c];c++)u._parts[p]=null;if(r=t.directory(),s=this.directory(),r===s)return u._parts.path="./"+u.filename(),u.build();if(a=r.substring(e.length),o=s.substring(e.length),r+"/"===e)return o&&(o+="/"),u._parts.path="./"+o+u.filename(),u.build();for(var l="../",d=RegExp("^"+i(e)),f=r.replace(d,"/").match(/\//g).length-1;f--;)l+="../";return u._parts.path=u._parts.path.replace(d,l),u.build()},c.equals=function(t){var e,r,i,s=this.clone(),o=new n(t),u={},p={},c={};if(s.normalize(),o.normalize(),""+s==""+o)return!0;if(e=s.query(),r=o.query(),s.query(""),o.query(""),""+s!=""+o)return!1;if(e.length!==r.length)return!1;u=n.parseQuery(e),p=n.parseQuery(r);for(i in u)if(l.call(u,i)){if(a(u[i])){if(!h(u[i],p[i]))return!1}else if(u[i]!==p[i])return!1;c[i]=!0}for(i in p)if(l.call(p,i)&&!c[i])return!1;return!0},c.duplicateQueryParameters=function(t){return this._parts.duplicateQueryParameters=!!t,this},n});var requirejs,require,define;(function(global){function isFunction(t){return"[object Function]"===ostring.call(t)}function isArray(t){return"[object Array]"===ostring.call(t)}function each(t,e){if(t){var r;for(r=0;t.length>r&&(!t[r]||!e(t[r],r,t));r+=1);}}function eachReverse(t,e){if(t){var r;for(r=t.length-1;r>-1&&(!t[r]||!e(t[r],r,t));r-=1);}}function hasProp(t,e){return hasOwn.call(t,e)}function getOwn(t,e){return hasProp(t,e)&&t[e]}function eachProp(t,e){var r;for(r in t)if(hasProp(t,r)&&e(t[r],r))break}function mixin(t,e,r,n){return e&&eachProp(e,function(e,i){(r||!hasProp(t,i))&&(n&&"string"!=typeof e?(t[i]||(t[i]={}),mixin(t[i],e,r,n)):t[i]=e)}),t}function bind(t,e){return function(){return e.apply(t,arguments)}}function scripts(){return document.getElementsByTagName("script")}function getGlobal(t){if(!t)return t;var e=global;return each(t.split("."),function(t){e=e[t]}),e}function makeError(t,e,r,n){var i=Error(e+"\nhttp://requirejs.org/docs/errors.html#"+t);return i.requireType=t,i.requireModules=n,r&&(i.originalError=r),i}function newContext(t){function e(t){var e,r;for(e=0;t[e];e+=1)if(r=t[e],"."===r)t.splice(e,1),e-=1;else if(".."===r){if(1===e&&(".."===t[2]||".."===t[0]))break;e>0&&(t.splice(e-1,2),e-=2)}}function r(t,r,n){var i,s,a,o,u,h,p,c,l,d,f,m=r&&r.split("/"),g=m,v=q.map,y=v&&v["*"];if(t&&"."===t.charAt(0)&&(r?(g=getOwn(q.pkgs,r)?m=[r]:m.slice(0,m.length-1),t=g.concat(t.split("/")),e(t),s=getOwn(q.pkgs,i=t[0]),t=t.join("/"),s&&t===i+"/"+s.main&&(t=i)):0===t.indexOf("./")&&(t=t.substring(2))),n&&v&&(m||y)){for(o=t.split("/"),u=o.length;u>0;u-=1){if(p=o.slice(0,u).join("/"),m)for(h=m.length;h>0;h-=1)if(a=getOwn(v,m.slice(0,h).join("/")),a&&(a=getOwn(a,p))){c=a,l=u;break}if(c)break;!d&&y&&getOwn(y,p)&&(d=getOwn(y,p),f=u)}!c&&d&&(c=d,l=f),c&&(o.splice(0,l,c),t=o.join("/"))}return t}function n(t){isBrowser&&each(scripts(),function(e){return e.getAttribute("data-requiremodule")===t&&e.getAttribute("data-requirecontext")===_.contextName?(e.parentNode.removeChild(e),!0):void 0})}function i(t){var e=getOwn(q.paths,t);return e&&isArray(e)&&e.length>1?(n(t),e.shift(),_.require.undef(t),_.require([t]),!0):void 0}function s(t){var e,r=t?t.indexOf("!"):-1;return r>-1&&(e=t.substring(0,r),t=t.substring(r+1,t.length)),[e,t]}function a(t,e,n,i){var a,o,u,h,p=null,c=e?e.name:null,l=t,d=!0,f="";return t||(d=!1,t="_@r"+(S+=1)),h=s(t),p=h[0],t=h[1],p&&(p=r(p,c,i),o=getOwn(Q,p)),t&&(p?f=o&&o.normalize?o.normalize(t,function(t){return r(t,c,i)}):r(t,c,i):(f=r(t,c,i),h=s(f),p=h[0],f=h[1],n=!0,a=_.nameToUrl(f))),u=!p||o||n?"":"_unnormalized"+(R+=1),{prefix:p,name:f,parentMap:e,unnormalized:!!u,url:a,originalName:l,isDefine:d,id:(p?p+"!"+f:f)+u}}function o(t){var e=t.id,r=getOwn(E,e);return r||(r=E[e]=new _.Module(t)),r}function u(t,e,r){var n=t.id,i=getOwn(E,n);!hasProp(Q,n)||i&&!i.defineEmitComplete?o(t).on(e,r):"defined"===e&&r(Q[n])}function h(t,e){var r=t.requireModules,n=!1;e?e(t):(each(r,function(e){var r=getOwn(E,e);r&&(r.error=t,r.events.error&&(n=!0,r.emit("error",t)))}),n||req.onError(t))}function p(){globalDefQueue.length&&(apsp.apply(k,[k.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function c(t){delete E[t],delete A[t]}function l(t,e,r){var n=t.map.id;t.error?t.emit("error",t.error):(e[n]=!0,each(t.depMaps,function(n,i){var s=n.id,a=getOwn(E,s);!a||t.depMatched[i]||r[s]||(getOwn(e,s)?(t.defineDep(i,Q[s]),t.check()):l(a,e,r))}),r[n]=!0)}function d(){var t,e,r,s,a=1e3*q.waitSeconds,o=a&&_.startTime+a<(new Date).getTime(),u=[],p=[],c=!1,f=!0;if(!y){if(y=!0,eachProp(A,function(r){if(t=r.map,e=t.id,r.enabled&&(t.isDefine||p.push(r),!r.error))if(!r.inited&&o)i(e)?(s=!0,c=!0):(u.push(e),n(e));else if(!r.inited&&r.fetched&&t.isDefine&&(c=!0,!t.prefix))return f=!1}),o&&u.length)return r=makeError("timeout","Load timeout for modules: "+u,null,u),r.contextName=_.contextName,h(r);f&&each(p,function(t){l(t,{},{})}),o&&!s||!c||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,d()},50)),y=!1}}function f(t){hasProp(Q,t[0])||o(a(t[0],null,!0)).init(t[1],t[2])}function m(t,e,r,n){t.detachEvent&&!isOpera?n&&t.detachEvent(n,e):t.removeEventListener(r,e,!1)}function g(t){var e=t.currentTarget||t.srcElement;return m(e,_.onScriptLoad,"load","onreadystatechange"),m(e,_.onScriptError,"error"),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function v(){var t;for(p();k.length;){if(t=k.shift(),null===t[0])return h(makeError("mismatch","Mismatched anonymous define() module: "+t[t.length-1]));f(t)}}var y,b,_,x,w,q={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},E={},A={},P={},k=[],Q={},O={},S=1,R=1;return x={require:function(t){return t.require?t.require:t.require=_.makeRequire(t.map)},exports:function(t){return t.usingExports=!0,t.map.isDefine?t.exports?t.exports:t.exports=Q[t.map.id]={}:void 0},module:function(t){return t.module?t.module:t.module={id:t.map.id,uri:t.map.url,config:function(){return q.config&&getOwn(q.config,t.map.id)||{}},exports:Q[t.map.id]}}},b=function(t){this.events=getOwn(P,t.id)||{},this.map=t,this.shim=getOwn(q.shim,t.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},b.prototype={init:function(t,e,r,n){n=n||{},this.inited||(this.factory=e,r?this.on("error",r):this.events.error&&(r=bind(this,function(t){this.emit("error",t)})),this.depMaps=t&&t.slice(0),this.errback=r,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(t,e){this.depMatched[t]||(this.depMatched[t]=!0,this.depCount-=1,this.depExports[t]=e)},fetch:function(){if(!this.fetched){this.fetched=!0,_.startTime=(new Date).getTime();var t=this.map;return this.shim?(_.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return t.prefix?this.callPlugin():this.load()})),void 0):t.prefix?this.callPlugin():this.load()}},load:function(){var t=this.map.url;O[t]||(O[t]=!0,_.load(this.map.id,t))},check:function(){if(this.enabled&&!this.enabling){var t,e,r=this.map.id,n=this.depExports,i=this.exports,s=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,1>this.depCount&&!this.defined){if(isFunction(s)){if(this.events.error)try{i=_.execCb(r,s,n,i)}catch(a){t=a}else i=_.execCb(r,s,n,i);if(this.map.isDefine&&(e=this.module,e&&void 0!==e.exports&&e.exports!==this.exports?i=e.exports:void 0===i&&this.usingExports&&(i=this.exports)),t)return t.requireMap=this.map,t.requireModules=[this.map.id],t.requireType="define",h(this.error=t)}else i=s;this.exports=i,this.map.isDefine&&!this.ignore&&(Q[r]=i,req.onResourceLoad&&req.onResourceLoad(_,this.map,this.depMaps)),c(r),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var t=this.map,e=t.id,n=a(t.prefix);this.depMaps.push(n),u(n,"defined",bind(this,function(n){var i,s,p,l=this.map.name,d=this.map.parentMap?this.map.parentMap.name:null,f=_.makeRequire(t.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(l=n.normalize(l,function(t){return r(t,d,!0)})||""),s=a(t.prefix+"!"+l,this.map.parentMap),u(s,"defined",bind(this,function(t){this.init([],function(){return t},null,{enabled:!0,ignore:!0})})),p=getOwn(E,s.id),p&&(this.depMaps.push(s),this.events.error&&p.on("error",bind(this,function(t){this.emit("error",t)})),p.enable()),void 0):(i=bind(this,function(t){this.init([],function(){return t},null,{enabled:!0})}),i.error=bind(this,function(t){this.inited=!0,this.error=t,t.requireModules=[e],eachProp(E,function(t){0===t.map.id.indexOf(e+"_unnormalized")&&c(t.map.id)}),h(t)}),i.fromText=bind(this,function(r,n){var s=t.name,u=a(s),p=useInteractive;n&&(r=n),p&&(useInteractive=!1),o(u),hasProp(q.config,e)&&(q.config[s]=q.config[e]);try{req.exec(r)}catch(c){return h(makeError("fromtexteval","fromText eval for "+e+" failed: "+c,c,[e]))}p&&(useInteractive=!0),this.depMaps.push(u),_.completeLoad(s),f([s],i)}),n.load(t.name,f,i,q),void 0)})),_.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){A[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(t,e){var r,n,i;if("string"==typeof t){if(t=a(t,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[e]=t,i=getOwn(x,t.id))return this.depExports[e]=i(this),void 0;this.depCount+=1,u(t,"defined",bind(this,function(t){this.defineDep(e,t),this.check()})),this.errback&&u(t,"error",this.errback)}r=t.id,n=E[r],hasProp(x,r)||!n||n.enabled||_.enable(t,this)})),eachProp(this.pluginMaps,bind(this,function(t){var e=getOwn(E,t.id);e&&!e.enabled&&_.enable(t,this)
})),this.enabling=!1,this.check()},on:function(t,e){var r=this.events[t];r||(r=this.events[t]=[]),r.push(e)},emit:function(t,e){each(this.events[t],function(t){t(e)}),"error"===t&&delete this.events[t]}},_={config:q,contextName:t,registry:E,defined:Q,urlFetched:O,defQueue:k,Module:b,makeModuleMap:a,nextTick:req.nextTick,onError:h,configure:function(t){t.baseUrl&&"/"!==t.baseUrl.charAt(t.baseUrl.length-1)&&(t.baseUrl+="/");var e=q.pkgs,r=q.shim,n={paths:!0,config:!0,map:!0};eachProp(t,function(t,e){n[e]?"map"===e?(q.map||(q.map={}),mixin(q[e],t,!0,!0)):mixin(q[e],t,!0):q[e]=t}),t.shim&&(eachProp(t.shim,function(t,e){isArray(t)&&(t={deps:t}),!t.exports&&!t.init||t.exportsFn||(t.exportsFn=_.makeShimExports(t)),r[e]=t}),q.shim=r),t.packages&&(each(t.packages,function(t){var r;t="string"==typeof t?{name:t}:t,r=t.location,e[t.name]={name:t.name,location:r||t.name,main:(t.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),q.pkgs=e),eachProp(E,function(t,e){t.inited||t.map.unnormalized||(t.map=a(e))}),(t.deps||t.callback)&&_.require(t.deps||[],t.callback)},makeShimExports:function(t){function e(){var e;return t.init&&(e=t.init.apply(global,arguments)),e||t.exports&&getGlobal(t.exports)}return e},makeRequire:function(e,n){function i(r,s,u){var p,c,l;return n.enableBuildCallback&&s&&isFunction(s)&&(s.__requireJsBuild=!0),"string"==typeof r?isFunction(s)?h(makeError("requireargs","Invalid require call"),u):e&&hasProp(x,r)?x[r](E[e.id]):req.get?req.get(_,r,e,i):(c=a(r,e,!1,!0),p=c.id,hasProp(Q,p)?Q[p]:h(makeError("notloaded",'Module name "'+p+'" has not been loaded yet for context: '+t+(e?"":". Use require([])")))):(v(),_.nextTick(function(){v(),l=o(a(null,e)),l.skipMap=n.skipMap,l.init(r,s,u,{enabled:!0}),d()}),i)}return n=n||{},mixin(i,{isBrowser:isBrowser,toUrl:function(t){var n,i=t.lastIndexOf("."),s=t.split("/")[0],a="."===s||".."===s;return-1!==i&&(!a||i>1)&&(n=t.substring(i,t.length),t=t.substring(0,i)),_.nameToUrl(r(t,e&&e.id,!0),n,!0)},defined:function(t){return hasProp(Q,a(t,e,!1,!0).id)},specified:function(t){return t=a(t,e,!1,!0).id,hasProp(Q,t)||hasProp(E,t)}}),e||(i.undef=function(t){p();var r=a(t,e,!0),n=getOwn(E,t);delete Q[t],delete O[r.url],delete P[t],n&&(n.events.defined&&(P[t]=n.events),c(t))}),i},enable:function(t){var e=getOwn(E,t.id);e&&o(t).enable()},completeLoad:function(t){var e,r,n,s=getOwn(q.shim,t)||{},a=s.exports;for(p();k.length;){if(r=k.shift(),null===r[0]){if(r[0]=t,e)break;e=!0}else r[0]===t&&(e=!0);f(r)}if(n=getOwn(E,t),!e&&!hasProp(Q,t)&&n&&!n.inited){if(!(!q.enforceDefine||a&&getGlobal(a)))return i(t)?void 0:h(makeError("nodefine","No define call for "+t,null,[t]));f([t,s.deps||[],s.exportsFn])}d()},nameToUrl:function(t,e,r){var n,i,s,a,o,u,h,p,c;if(req.jsExtRegExp.test(t))p=t+(e||"");else{for(n=q.paths,i=q.pkgs,o=t.split("/"),u=o.length;u>0;u-=1){if(h=o.slice(0,u).join("/"),s=getOwn(i,h),c=getOwn(n,h)){isArray(c)&&(c=c[0]),o.splice(0,u,c);break}if(s){a=t===s.name?s.location+"/"+s.main:s.location,o.splice(0,u,a);break}}p=o.join("/"),p+=e||(/\?/.test(p)||r?"":".js"),p=("/"===p.charAt(0)||p.match(/^[\w\+\.\-]+:/)?"":q.baseUrl)+p}return q.urlArgs?p+((-1===p.indexOf("?")?"?":"&")+q.urlArgs):p},load:function(t,e){req.load(_,t,e)},execCb:function(t,e,r,n){return e.apply(n,r)},onScriptLoad:function(t){if("load"===t.type||readyRegExp.test((t.currentTarget||t.srcElement).readyState)){interactiveScript=null;var e=g(t);_.completeLoad(e.id)}},onScriptError:function(t){var e=g(t);return i(e.id)?void 0:h(makeError("scripterror","Script error",t,[e.id]))}},_.require=_.makeRequire(),_}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(t){return"interactive"===t.readyState?interactiveScript=t:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.5",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||!navigator||!document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"==""+opera,contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(requirejs!==void 0){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(t,e,r,n){var i,s,a=defContextName;return isArray(t)||"string"==typeof t||(s=t,isArray(e)?(t=e,e=r,r=n):t=[]),s&&s.context&&(a=s.context),i=getOwn(contexts,a),i||(i=contexts[a]=req.s.newContext(a)),s&&i.configure(s),i.require(t,e,r)},req.config=function(t){return req(t)},req.nextTick="undefined"!=typeof setTimeout?function(t){setTimeout(t,4)}:function(t){t()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(t){req[t]=function(){var e=contexts[defContextName];return e.require[t].apply(e,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(t){throw t},req.load=function(t,e,r){var n,i=t&&t.config||{};if(isBrowser)return n=i.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),n.type=i.scriptType||"text/javascript",n.charset="utf-8",n.async=!0,n.setAttribute("data-requirecontext",t.contextName),n.setAttribute("data-requiremodule",e),!n.attachEvent||n.attachEvent.toString&&0>(""+n.attachEvent).indexOf("[native code")||isOpera?(n.addEventListener("load",t.onScriptLoad,!1),n.addEventListener("error",t.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",t.onScriptLoad)),n.src=r,currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{importScripts(r),t.completeLoad(e)}catch(s){t.onError(makeError("importscripts","importScripts failed for "+e+" at "+r,s,[e]))}},isBrowser&&eachReverse(scripts(),function(t){return head||(head=t.parentNode),dataMain=t.getAttribute("data-main"),dataMain?(cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript),dataMain=dataMain.replace(jsSuffixRegExp,""),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain],!0):void 0}),define=function(t,e,r){var n,i;"string"!=typeof t&&(r=e,e=t,t=null),isArray(e)||(r=e,e=[]),!e.length&&isFunction(r)&&r.length&&((""+r).replace(commentRegExp,"").replace(cjsRequireRegExp,function(t,r){e.push(r)}),e=(1===r.length?["require"]:["require","exports","module"]).concat(e)),useInteractive&&(n=currentlyAddingScript||getInteractiveScript(),n&&(t||(t=n.getAttribute("data-requiremodule")),i=contexts[n.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([t,e,r])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}})(this),function(){var t={}.hasOwnProperty,e=function(e,r){function n(){this.constructor=e}for(var i in r)t.call(r,i)&&(e[i]=r[i]);return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e};define("social-buttons/adapters/facebook",["social-buttons/button"],function(){var t,r,n;return t=require("social-buttons/button"),r=function(t){function r(){return n=r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.className="facebook",r.prototype.countUrl=function(){return"https://api.facebook.com/method/fql.query?format=json&query="+encodeURIComponent('SELECT share_count FROM link_stat WHERE url="'+this.getShareLink()+'"')},r.prototype.shareUrl="",r}(t)})}.call(this),function(){var t={}.hasOwnProperty,e=function(e,r){function n(){this.constructor=e}for(var i in r)t.call(r,i)&&(e[i]=r[i]);return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e};define("social-buttons/adapters/twitter",["social-buttons/button"],function(){var t,r,n;return t=require("social-buttons/button"),r=function(t){function r(){return n=r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.className="twitter",r}(t)})}.call(this),function(){var t={}.hasOwnProperty,e=function(e,r){function n(){this.constructor=e}for(var i in r)t.call(r,i)&&(e[i]=r[i]);return n.prototype=r.prototype,e.prototype=new n,e.__super__=r.prototype,e};define("social-buttons/adapters/vkontakte",["social-buttons/button"],function(){var t,r,n;return t=require("social-buttons/button"),r=function(t){function r(){return n=r.__super__.constructor.apply(this,arguments)}return e(r,t),r.prototype.className="vkontakte",r}(t)})}.call(this),function(){var t={}.hasOwnProperty;define("social-buttons/button",function(){var e;return e=function(){function e(t,r){this.$el=t,this.passedOptions=r,this.cid="button"+e.lastIndex,e.lastIndex++,this.initEl(),this.count(),this.el=this.$el.get(),this.delegateEvents()}return e.prototype.initEl=function(){return null!=this.className&&this.$el.addClass(this.className),this.$el.html(this.template()),this},e.prototype.count=function(){return console.log(this.getUrl("count"))},e.prototype.delegateEvents=function(){var r,n,i,s,a,o=this;a=jQuery.extend({},e.prototype.events,this.events);for(r in a)if(t.call(a,r)){if(n=a[r],s=r.split(/\s/)[0],i=r.split(/\s/).slice(1).join(" "),"function"!=typeof n){if(null==this[n])throw Error("Method '"+n+"' is not defined");n=this[n]}this.$el.on(""+r+".button"+this.cid,i,function(){return n.apply(o,arguments)})}return this},e.prototype.undelegateEvents=function(){return this.$el.off(".button"+this.cid),this},e.prototype.getShareLink=function(){var e,r,n,i;n=URI.parse("http://foo:bar@ya.ru/foo/bar/?baz=a&a=bas#12312"),e=new URI,e.hostname;for(r in n)t.call(n,r)&&(i=n[r],e[r]()||(e=e[r](i)));return console.log(""+e)},e.prototype.getUrl=function(t){return null==t&&(t="count"),"count"!==t&&"share"!==t?null:"function"==typeof this[""+t+"Url"]?this[""+t+"Url"]()+"":this[""+t+"Url"]+""},e.prototype.countUrl="",e.prototype.shareUrl="",e.prototype.options=function(){var t;return t={link:this.$el.prop("href")},jQuery.extend(t,this.defaults,this.passedOptions,this.$el.data())},e.prototype.events={},e.lastIndex=0,e.prototype.template=function(){return $.trim('<i class="b-share-button__icon"></i>\n<span class="b-share-button__count js-share-button__count"></span>')},e}()})}.call(this),function(){define("social-buttons",["social-buttons/adapters/facebook","social-buttons/adapters/vkontakte","social-buttons/adapters/twitter"],function(){var t;return t=function(){function t(){}return t.adapters={facebook:require("social-buttons/adapters/facebook"),vkontakte:require("social-buttons/adapters/vkontakte"),twitter:require("social-buttons/adapters/twitter")},t}(),jQuery.prototype.socialButton=function(e){var r,n,i,s,a,o;for(null==e&&(e={}),i=a=0,o=this.length;o>a;i=++a)n=this[i],r=$(n),s=r.data("network"),null!=t.adapters[s]&&new t.adapters[s](r,e);return this}})}.call(this);